# 内容简介
这是我学习Monod方程的笔记和参数拟合案例学习。

# 文件介绍
<br>- Excel文件中是模拟数据集，请根据Excel文件中的数据，拟合出相应的 $\mu_{max}$ 和 $K_s$ （真实值，$\mu_{max}$： 0.8 h⁻¹；$K_s$：2.5 g/L）
<br>- jupyter文件中是我的代码

# 知识点

#### Monod方程
$$
μ = μ_{max} · \frac{S}{K_S + S}
$$

#### 基本事实
- 底物浓度极低时，比生长速率 $\mu$ 与菌体浓度 S 成“正比例”关系
- 底物浓度极高时，$\mu$ 不再随 S 变大而变大，而是趋于一个最大值 $\mu_{max}$

#### 设想过程
1. 拟合第一条基本事实，则 $\mu$ = k * S （k为某一常数）
2. 拟合第二条基本事实，则 分母必须为 （ C + S ）；且 k = $\mu_{max}$
3. 即 $\mu$ = $\mu_{max} · \frac{S}{C + S} $
4. 确定 C 的物理意义：代入 S = C 可得，C = 0.5 $\mu_{max}$ ；即 C 为比生长速率达到一半时的底物浓度 ---> 定义为：$K_s$ “半饱和常数”

#### 物理意义
- $ \mu_{max}$ ：该菌体在该底物下的最大比生长速率，反映了“生长潜力”
- $K_s$ ：“半饱和常数”——比生长速率达到一半时的底物浓度，反映了“底物亲和力”

#### 参数拟合（$ \mu_{max}$，$K_s$）
#### 分析：
1. 显然，方程关于 S 和 $\mu$ 不是线性函数 --> 用非线性最小二乘法求解
2. 要想拟合得到$ \mu_{max}$和$K_s$，就必须要准备多个 S 和对应的 $\mu$ [高（$\mu$ >> $K_s$）、中（$\mu$ ≈ $K_s$）、低（$\mu$ << $K_s$）区间都需要]

#### 代码所用库
- numpy
- pandas
- matplotlib
- scipy
- sklearn

#### 拟合方法
Python中curve_fit函数：非线性最小二乘拟合

curve_fit是Python中scipy.optimize模块下的核心函数，专门用于非线性最小二乘拟合——通过最小化模型预测值与实验数据的残差平方和，找到最优的模型参数，是科研、工程中拟合非线性函数（如Monod方程、指数函数、高斯函数等）的常用工具。

一、基本用法


1. 核心参数说明（按重要性排序）

参数

f

待拟合的模型函数（需提前定义出来），格式为f(x, p1, p2, ...)：
<br>- 第一个参数x是自变量（数组）；
<br>- 后续参数p1,p2...是待拟合的参数（标量）；
<br>- 返回值是模型预测的因变量（需与ydata长度一致）。

xdata

自变量的实验数据（一维/多维数组），需与模型函数f的自变量维度匹配（如Monod方程中是底物浓度S）。

ydata

因变量的实验数据（一维数组），必须与xdata长度一致（如Monod方程中是比生长速率$\mu$）。

p0

**可选**，参数的初始猜测值（列表/数组），顺序与f的参数一致：
<br>- 默认None，算法自动设为全1；
<br>- 建议根据物理意义设定（如Monod方程中p0=[0.5, 1.0]），能大幅提升收敛速度和准确性。

sigma

可选，观测值ydata的权重（一维数组）：
<br>- 若设为实验数据的标准差，算法会按权重拟合（更贴合实际误差）；
<br>- 默认None，所有数据等权重。

bounds

可选，参数的边界约束（元组/列表），格式为(lower, upper)：
<br>- lower：各参数的下限（数组/标量，标量表示所有参数同一下限）；
<br>- upper：各参数的上限（数组/标量）；
<br>- 默认(-np.inf, np.inf)（无约束，易出现物理无意义的负参数）。

maxfev

可选，最大函数调用/迭代次数（整数）：
<br>- 默认800，非线性拟合建议增大（如5000），避免因迭代不足未收敛；
<br>- 设为-1表示无限制（不推荐，易卡死）。

3. 返回值说明

popt

最优拟合参数数组（顺序与f的参数一致）；

pcov

参数的协方差矩阵：<br>- 对角线元素是参数的方差，平方根为标准误差（反映参数的不确定性）；<br>- 非对角线元素是参数间的协方差（反映参数相关性）。

二、关键使用场景与示例

    popt, pcov = curve_fit(
        f=monod,
        xdata=S_exp,
        ydata=mu_exp,
        p0=[0.5, 1.0],  # 初始猜测
        bounds=bounds,
        maxfev=5000
    )


三、总结

curve_fit的核心优势是易用性+适配性：  

- 无需手动实现最小二乘算法，只需定义模型函数和输入实验数据；  

- 通过bounds、p0、maxfev等参数，可适配不同非线性模型的拟合需求；  

- 返回的协方差矩阵可量化参数的不确定性，满足科研中“拟合+误差分析”的完整需求。  

使用时需牢记：参数设置必须贴合模型的物理意义（如Monod参数非负），否则拟合结果再“好看”也无实际价值。





















