
# 一、知识学习与回顾
## 1. 什么是PCA
由多个特征的多组样本组成矩阵，通过线性变换等一系列线性代数方法，找到最能表示原数据的向量，再将数据投影到该向量上，从而达到降维的效果。

## 2. PCA分析的应用
在生物工程领域，PCA分析主要有以下两个核心应用方向：
- **数据降维压缩**：在基因组学等研究中，常面临成千上万个维度的复杂数据，通过PCA分析可提取出2-3个主成分，有效实现数据降维。下文案例1即为PCA降维处理的简单演示。
- **评估实验结果和处理影响**：通过PCA分析并绘制得分图，能够判断实验样本处理及实验过程实施是否存在错误。如下文案例2中，若同一标签的样本出现较大偏离，则表明实验可能存在问题。

## 3. 核心知识点
### 3.1 方差
方差用于表示单个变量中数值的离散程度，分为总体方差和样本方差：
- **总体方差**：$s_{x}^{2}=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}$
- **样本方差**：$s_{x}^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\overline{x})^{2}$

### 3.2 协方差
协方差用于表示两个变量之间的线性相关程度（本质是两个变量标准差的乘积），分为总体协方差和样本协方差，且具有明确的意义解释：
- **总体协方差**：$cov(X,Y)=\frac{1}{n}\sum_{i=1}^{n}(x_{i}-\overline{x})(y_{i}-\overline{y})$
- **样本协方差**：$cov(X,Y)=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\overline{x})(y_{i}-\overline{y})$
- **协方差的意义**：
  - $cov(X,Y)>0$：两个变量呈正相关关系；
  - $cov(X,Y)<0$：两个变量呈负相关关系；
  - $cov(X,Y)\approx0$：两个变量无明显线性相关。

### 3.3 协方差矩阵（对称矩阵）
协方差矩阵的元素包含变量自身方差与变量间协方差，具体定义如下：
- **对角线元素**：$s_{ii}=cov(X_{i},X_{i})=s_{X_{i}}^{2}$，即变量$X_{i}$的自身方差，用于表示该变量的波动程度；
- **非对角线元素**：$s_{ij}=cov(X_{i},X_{j})$（$i\neq j$），即变量$X_{i}$与$X_{j}$的协方差，用于表示两个变量的线性相关程度。

## 4. 计算步骤
### （1）中心化
使所有数据中同一特征的均值为零，具体操作是将所有数据减去对应特征的均值。

### （2）计算协方差矩阵（一般使用样本协方差矩阵）
对于包含$n$个样本、$p$个变量的数据集（矩阵形式为$X_{n\times p}$，其中每行代表一个样本，每列代表一个变量），样本协方差矩阵的通用计算公式为：
$S_{p\times p}=\frac{1}{n-1}(X-\overline{X})^{T}(X-\overline{X})$
其中，$\overline{X}_{n\times p}$是“均值矩阵”，其每行均为所有变量的均值向量$[\overline{x}_{1},\overline{x}_{2},...,\overline{x}_{p}]$。

### （3）特征值分解
即计算协方差矩阵的特征向量和特征值，其核心依据线性代数中矩阵特征值与特征向量的计算原理，且将特征向量单位化后即为主成分，对应的特征值在总特征值中的百分比即为该主成分的占比。

### （4）排序，选择主成分
依据特征值的大小，从大到小依次将对应的主成分命名为主成分1、主成分2、主成分3等，再根据特征值占比和实际需求，选取合适数量的主成分。

### （5）投影数据
将中心化后的数据投影到选取的各个主成分上，并通过图表形式实现可视化展示。

## 5. 课堂回顾[参考文献1]
### （1）求特征值
设协方差矩阵为$A$，特征值为$\lambda$，则通过求解特征方程$|\lambda E - A|=0$得到特征值$\lambda$。

### （2）求特征向量
- 将求得的特征值$\lambda$代入，得到矩阵$\lambda E - A = D$；
- 将矩阵$D$化为行阶梯形矩阵；
- 求解行阶梯形矩阵的解，即可得到对应的特征向量$P$。

### （3）单位化公式
单位化后的向量计算公式为：$u=\frac{P}{||P||}$；
其中，$||P||=\sqrt{\langle P,P\rangle}$（$\langle P,P\rangle$表示向量$P$的内积）。
